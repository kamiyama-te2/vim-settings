-- プラグインの読み込み
-- cfilterプラグインを読み込み（クイックフィックスリストのフィルタリング機能）
vim.cmd('packadd cfilter')
-- 診断メッセージの仮想テキスト表示を無効化（画面がごちゃごちゃするのを防ぐ）
vim.diagnostic.config({
  virtual_text = false,
})

-- =============================================================================
-- 不可視文字の表示設定
-- =============================================================================
-- 不可視文字の表示を有効化
vim.opt.list = true
-- 各不可視文字の表示方法を設定
vim.opt.listchars:append {
  trail = "~",    -- 行末の空白文字を ~ で表示
  tab = ">-",     -- タブ文字を >- で表示
  nbsp = "␣",     -- ノーブレークスペースを ␣ で表示
}

-- =============================================================================
-- 検索・置換設定
-- =============================================================================
-- 置換時のライブプレビューを有効化（入力中にリアルタイムで結果を表示）
vim.opt.inccommand = 'split'

-- =============================================================================
-- スクロール・カーソル設定
-- =============================================================================
-- カーソルの上下に最低10行を保持（スクロール時の余白）
vim.opt.scrolloff = 10

-- 現在行のハイライト表示設定
vim.opt.cursorline = true              -- カーソル行をハイライト
vim.opt.cursorlineopt = "number"       -- 行番号のみハイライト（行全体ではない）
-- カーソル行番号の色設定（コメントアウト）
-- vim.api.nvim_set_hl(0, 'CursorLineNr', { bold = true, ctermfg = 11, foreground = 'Yellow' })

-- =============================================================================
-- 折りたたみ設定
-- =============================================================================
-- コードの折りたたみ機能を無効化
vim.opt.foldenable = false

-- =============================================================================
-- テキスト表示・編集設定
-- =============================================================================
-- コマンド履歴の保存数
vim.opt.history = 200

-- =============================================================================
-- 検索設定
-- =============================================================================
vim.opt.hlsearch = false      -- 検索結果のハイライトを無効化
vim.opt.incsearch = true      -- インクリメンタル検索（入力中に検索）
vim.opt.ignorecase = true     -- 大文字小文字を区別しない検索
vim.opt.smartcase = true      -- 大文字が含まれる場合は区別する

-- =============================================================================
-- 表示設定
-- =============================================================================
-- 行の折り返し表示を無効化（長い行は横スクロールで表示）
vim.opt.wrap = false

-- =============================================================================
-- アンドゥ（元に戻す）設定
-- =============================================================================
-- アンドゥファイルの保存場所とファイル永続化
local home = os.getenv("HOME") or os.getenv("USERPROFILE") or "."
vim.opt.undodir = home .. "/.vim/undodir"  -- アンドゥファイルの保存先
vim.opt.undofile = true                    -- ファイルを閉じてもアンドゥ履歴を保持

-- =============================================================================
-- 色設定
-- =============================================================================
-- True Color（24bit色）サポートを有効化
vim.opt.termguicolors = true

-- =============================================================================
-- 行番号設定
-- =============================================================================
vim.opt.number = true         -- 行番号を表示
vim.opt.relativenumber = true -- 相対行番号を表示（現在行からの距離）

-- =============================================================================
-- マウス設定
-- =============================================================================
-- 全モードでマウス操作を有効化
vim.opt.mouse = 'a'

-- =============================================================================
-- ステータス表示設定
-- =============================================================================
-- モード表示を無効化（ステータスラインプラグインで表示するため）
vim.opt.showmode = false

-- =============================================================================
-- ウィンドウ分割設定
-- =============================================================================
vim.opt.splitright = true    -- 縦分割時に新しいウィンドウを右側に配置
-- vim.opt.splitbelow = true -- 横分割時に新しいウィンドウを下側に配置（コメントアウト）

-- =============================================================================
-- クリップボード設定
-- =============================================================================
-- OS のクリップボードと Neovim のレジスタを同期
vim.opt.clipboard = 'unnamedplus'

-- =============================================================================
-- インデント設定
-- =============================================================================
-- 改行時のインデントを継続
vim.opt.breakindent = true

-- =============================================================================
-- サインカラム設定
-- =============================================================================
-- 左端のサインカラム（エラー表示等）を常に表示
vim.wo.signcolumn = 'yes'

-- =============================================================================
-- 応答性設定
-- =============================================================================
vim.opt.updatetime = 250      -- ファイル更新の検出間隔（ミリ秒）
vim.opt.timeoutlen = 300      -- キーマッピングのタイムアウト時間（ミリ秒）

-- =============================================================================
-- 補完設定
-- =============================================================================
-- 補完メニューの動作設定
vim.opt.completeopt = 'menuone,noselect'  -- メニューを常に表示、自動選択なし

-- =============================================================================
-- タブ・インデント設定
-- =============================================================================
vim.opt.tabstop = 4        -- タブ文字の表示幅（4文字分）
vim.opt.shiftwidth = 4     -- 自動インデントの幅（4文字分）
vim.opt.softtabstop = 4    -- タブキー押下時の挿入幅（4文字分）
vim.opt.expandtab = true   -- タブ文字をスペースに変換
vim.opt.swapfile = false   -- スワップファイルを作成しない

-- =============================================================================
-- 不要機能の無効化（パフォーマンス向上）
-- =============================================================================
-- Neovim 起動時間短縮のため、使用しない内蔵プラグインを無効化
vim.g.loaded_gzip = 1            -- gzip ファイル処理
vim.g.loaded_zip = 1             -- zip ファイル処理  
vim.g.loaded_zipPlugin = 1       -- zip プラグイン
vim.g.loaded_tar = 1             -- tar ファイル処理
vim.g.loaded_tarPlugin = 1       -- tar プラグイン
vim.g.loaded_getscript = 1       -- getscript プラグイン
vim.g.loaded_getscriptPlugin = 1 -- getscript プラグイン
vim.g.loaded_vimball = 1         -- vimball プラグイン
vim.g.loaded_vimballPlugin = 1   -- vimball プラグイン
vim.g.loaded_2html_plugin = 1    -- HTML 変換プラグイン
vim.g.loaded_matchit = 1         -- matchit プラグイン
vim.g.loaded_matchparen = 1      -- 対応括弧ハイライト
vim.g.loaded_logiPat = 1         -- 論理パターンプラグイン
vim.g.loaded_rrhelper = 1        -- rrhelper プラグイン
vim.g.loaded_netrw = 1           -- ファイルエクスプローラー
vim.g.loaded_netrwPlugin = 1     -- netrw プラグイン
vim.g.loaded_netrwSettings = 1   -- netrw 設定
